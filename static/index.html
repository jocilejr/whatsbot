<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WhatsApp Bot - Sistema de Gestão</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

  <style>
    :root{
      --brand:#25D366;
      --brand-700:#128C7E;
      --bg-a:#667eea;
      --bg-b:#764ba2;
      --card-bg:rgba(255,255,255,.95);
      --muted:#64748b;
      --ink:#1f2937;
      --ink-2:#374151;
      --radius:18px;
      --shadow-lg:0 10px 30px rgba(0,0,0,.10);
      --shadow-xl:0 20px 40px rgba(0,0,0,.15);
    }

    /* Reset & base */
    *{margin:0;padding:0;box-sizing:border-box}
    html,body{height:100%}
    body{
      font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;
      background:linear-gradient(135deg,var(--bg-a) 0%,var(--bg-b) 100%);
      color:#333; min-height:100vh; overflow-x:hidden;
    }

    .app-container{display:flex;min-height:100vh}

    /* Sidebar */
    .sidebar{
      width:280px;background:var(--card-bg);backdrop-filter:blur(15px);
      box-shadow:2px 0 20px rgba(0,0,0,.1);
      display:flex;flex-direction:column;position:fixed;inset:0 auto 0 0;z-index:1000;
      transition:transform .3s ease;
    }
    .sidebar-header{padding:25px;border-bottom:1px solid rgba(0,0,0,.08);
      background:linear-gradient(135deg,var(--brand),var(--brand-700));color:#fff}
    .sidebar-header h2{font-size:20px;font-weight:700;display:flex;align-items:center;gap:12px}
    .logo-icon{width:40px;height:40px;background:rgba(255,255,255,.2);border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px}

    .sidebar-nav{flex:1;padding:20px 0;overflow-y:auto}
    .nav-section{margin-bottom:30px}
    .nav-section-title{padding:0 25px 10px;font-size:12px;font-weight:600;color:var(--muted);text-transform:uppercase;letter-spacing:.5px}
    .nav-item{
      display:flex;align-items:center;padding:12px 25px;color:#475569;text-decoration:none;
      transition:all .3s ease;border-left:3px solid transparent;cursor:pointer
    }
    .nav-item .nav-icon{width:20px;margin-right:15px;text-align:center;font-size:16px}
    .nav-item .nav-text{flex:1;font-size:14px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .nav-item .nav-badge{background:#ef4444;color:#fff;font-size:11px;padding:2px 8px;border-radius:12px;font-weight:600}
    .nav-item:hover{background:rgba(37,211,102,.10);color:var(--brand);border-left-color:var(--brand)}
    .nav-item.active{background:rgba(37,211,102,.15);color:var(--brand);border-left-color:var(--brand);font-weight:600}

    /* Mobile toggle & overlay */
    .mobile-menu-toggle{
      display:none;position:fixed;top:20px;left:20px;z-index:1001;
      background:rgba(255,255,255,.9);border:none;padding:12px;border-radius:12px;cursor:pointer;
      box-shadow:0 4px 12px rgba(0,0,0,.1)
    }
    .sidebar-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:999}
    .sidebar-overlay.active{display:block}

    /* Main */
    .main-content{flex:1;margin-left:280px;padding:0;transition:margin-left .3s ease}
    .container{max-width:1200px;margin:0 auto;padding:30px}

    /* Header */
    .header{
      background:var(--card-bg);backdrop-filter:blur(10px);border-radius:20px;
      padding:25px 30px;margin-bottom:30px;box-shadow:var(--shadow-lg);
      display:flex;justify-content:space-between;align-items:center
    }
    .header h1{font-size:28px;font-weight:700;color:#2d3748;display:flex;align-items:center;gap:12px}
    .header h1 i{color:var(--brand);font-size:32px}

    /* Buttons */
    .btn-primary{
      background:linear-gradient(135deg,var(--brand),var(--brand-700));color:#fff;border:none;
      padding:12px 24px;border-radius:12px;font-weight:600;font-size:14px;cursor:pointer;transition:all .3s ease;
      display:flex;align-items:center;gap:8px;text-decoration:none
    }
    .btn-primary:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(37,211,102,.3)}

    .btn-action{
      flex:1;padding:8px 16px;border:none;border-radius:8px;font-weight:600;font-size:12px;cursor:pointer;transition:all .3s ease;
      display:flex;align-items:center;justify-content:center;gap:6px
    }
    .btn-action:hover{transform:translateY(-1px)}
    .btn-edit{background:#3b82f6;color:#fff}
    .btn-delete{background:#ef4444;color:#fff}
    .btn-connect{background:var(--brand);color:#fff}

    /* Metrics */
    .dashboard-metrics{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px;margin-bottom:30px}
    .metric-card{background:var(--card-bg);backdrop-filter:blur(10px);border-radius:16px;padding:20px;box-shadow:var(--shadow-lg);transition:all .3s ease}
    .metric-card:hover{transform:translateY(-3px);box-shadow:0 15px 35px rgba(0,0,0,.15)}
    .metric-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:15px}
    .metric-title{font-size:14px;font-weight:600;color:var(--muted)}
    .metric-icon{width:35px;height:35px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:16px;background:#dcfce7;color:#16a34a}
    .metric-value{font-size:28px;font-weight:700;color:var(--ink);margin-bottom:8px}
    .metric-subtitle{font-size:12px;color:#6b7280;margin-bottom:15px}

    .metric-breakdown{border-top:1px solid #f1f5f9;padding-top:10px}
    .breakdown-item{display:flex;justify-content:space-between;align-items:center;padding:3px 0;font-size:12px}
    .breakdown-label{color:var(--muted)}
    .breakdown-value{font-weight:600;color:var(--ink-2)}

    /* Cards / grids */
    .content-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:25px}
    .content-card{
      background:var(--card-bg);backdrop-filter:blur(10px);border-radius:var(--radius);padding:25px;box-shadow:var(--shadow-lg);
      transition:all .3s ease;position:relative;overflow:hidden
    }
    .content-card:hover{transform:translateY(-5px);box-shadow:var(--shadow-xl)}
    .card-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:15px}
    .card-title{font-size:18px;font-weight:700;color:var(--ink);margin-bottom:5px}
    .card-subtitle{font-size:14px;color:#6b7280;line-height:1.5}
    .card-status{position:absolute;top:15px;right:15px;padding:4px 10px;border-radius:15px;font-size:11px;font-weight:600;text-transform:uppercase}
    .status-active{background:#dcfce7;color:#166534}
    .status-pending{background:#fef3c7;color:#92400e}
    .status-offline{background:#f3f4f6;color:#4b5563}

    /* Tables */
    .data-table{background:var(--card-bg);backdrop-filter:blur(10px);border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow-lg)}
    .table-header{background:#f8fafc;padding:20px 25px;border-bottom:1px solid #e5e7eb}
    .table-title{font-size:18px;font-weight:700;color:var(--ink)}
    .table-content{overflow-x:auto}
    table{width:100%;border-collapse:collapse}
    th,td{padding:15px 25px;text-align:left;border-bottom:1px solid #f1f5f9}
    th{background:#f8fafc;font-weight:600;color:var(--ink-2);font-size:14px}
    td{color:#4b5563;font-size:14px}

    .status-badge{display:inline-flex;align-items:center;gap:5px;padding:4px 8px;border-radius:10px;font-size:11px;font-weight:600}
    .status-online{background:#dcfce7;color:#166534}
    .status-away{background:#fef3c7;color:#92400e}
    .status-error{background:#fee2e2;color:#991b1b}

    /* Instance selector (footer) */
    .sidebar-footer{margin-top:auto;border-top:1px solid rgba(0,0,0,.08);position:relative}
    .instance-selector{padding:20px;display:flex;align-items:center;gap:12px;cursor:pointer;transition:all .3s ease;background:rgba(37,211,102,.05)}
    .instance-selector:hover{background:rgba(37,211,102,.10)}
    .instance-avatar{position:relative;flex-shrink:0}
    .instance-avatar img{width:40px;height:40px;border-radius:50%;object-fit:cover;border:2px solid var(--brand)}
    .instance-status{position:absolute;bottom:0;right:0;width:12px;height:12px;background:#10B981;border:2px solid #fff;border-radius:50%}
    .instance-info{flex:1;min-width:0}
    .instance-name{font-size:14px;font-weight:600;color:var(--ink)}
    .instance-type{font-size:12px;color:var(--muted)}
    .instance-arrow{color:var(--muted);transition:transform .3s ease}
    .instance-arrow.active{transform:rotate(180deg)}

    .instance-dropdown{
      position:absolute;bottom:100%;left:0;right:0;background:#fff;border-radius:12px 12px 0 0;
      box-shadow:0 -10px 30px rgba(0,0,0,.2);opacity:0;visibility:hidden;transform:translateY(10px);
      transition:all .3s ease;z-index:1000;max-height:400px;overflow-y:auto
    }
    .instance-dropdown.active{opacity:1;visibility:visible;transform:translateY(0)}
    .dropdown-header{padding:15px 20px;border-bottom:1px solid #e5e7eb;font-size:12px;font-weight:600;color:var(--muted);text-transform:uppercase;letter-spacing:.5px}
    .instance-item{padding:12px 20px;display:flex;align-items:center;gap:12px;cursor:pointer;transition:all .3s ease}
    .instance-item:hover{background:#f8fafc}
    .instance-item.active{background:rgba(37,211,102,.10)}
    .instance-avatar-small{position:relative;flex-shrink:0}
    .instance-avatar-small img{width:32px;height:32px;border-radius:50%;object-fit:cover}
    .status-dot{position:absolute;bottom:0;right:0;width:10px;height:10px;border:2px solid #fff;border-radius:50%}
    .status-dot.active{background:#10B981}
    .status-dot.pending{background:#F59E0B}
    .status-dot.offline{background:#6B7280}
    .instance-details{flex:1;min-width:0}
    .instance-details .name{font-size:14px;font-weight:600;color:var(--ink)}
    .instance-details .type{font-size:12px;color:var(--muted)}
    .instance-check{color:var(--brand);font-size:14px}
    .dropdown-footer{border-top:1px solid #e5e7eb;padding:8px}
    .dropdown-action{padding:10px 16px;display:flex;align-items:center;gap:10px;cursor:pointer;border-radius:8px;transition:all .3s ease;font-size:13px;color:#475569}
    .dropdown-action:hover{background:#f1f5f9;color:var(--brand)}
    .dropdown-action i{width:16px;text-align:center}

    /* Forms */
    .form-group{margin-bottom:20px}
    .form-label{display:block;font-size:14px;font-weight:600;color:var(--ink-2);margin-bottom:8px}
    .form-input,.form-select,.form-textarea{
      width:100%;padding:12px 16px;border:2px solid #e5e7eb;border-radius:10px;font-size:14px;color:var(--ink-2);background:#fff;transition:border-color .3s ease
    }
    .form-input:focus,.form-select:focus,.form-textarea:focus{outline:none;border-color:var(--brand);box-shadow:0 0 0 3px rgba(37,211,102,.10)}
    .form-textarea{min-height:100px;resize:vertical}

    /* Settings grid */
    .settings-grid{display:grid;grid-template-columns:1fr 1fr;gap:30px;margin-bottom:30px}
    .advanced-settings{margin-top:30px}
    .advanced-settings .settings-grid{padding:20px;margin-bottom:0}

    /* Modal */
    .modal-overlay{position:fixed;inset:0;background:rgba(15,23,42,.55);backdrop-filter:blur(2px);display:flex;align-items:center;justify-content:center;z-index:2000}
    .modal-box{width:min(540px,92vw);background:#fff;border-radius:16px;overflow:hidden;box-shadow:0 25px 60px rgba(0,0,0,.25);animation:modalIn .16s ease-out}
    @keyframes modalIn{from{transform:translateY(6px);opacity:.9}to{transform:none;opacity:1}}
    .modal-header,.modal-footer{background:#f8fafc;border-color:#e5e7eb}
    .modal-header{padding:14px 18px;border-bottom:1px solid #e5e7eb;display:flex;justify-content:space-between;align-items:center}
    .modal-title{font-weight:700;color:#0f172a;font-size:16px}
    .modal-close{border:0;background:transparent;font-size:18px;color:#64748b;cursor:pointer}
    .modal-body{padding:18px;max-height:60vh;overflow:auto;color:#334155}
    .modal-footer{padding:12px;border-top:1px solid #e5e7eb;display:flex;justify-content:flex-end;gap:8px}
    .btn-ghost{background:#e5e7eb;color:#111827;padding:10px 14px;border-radius:10px;border:0;font-weight:600;cursor:pointer}
    .btn-ghost:hover{filter:brightness(.98)}
    .modal-form .form-row{margin-bottom:12px}
    .modal-form label{display:block;font-size:13px;font-weight:600;color:#374151;margin-bottom:6px}
    .modal-form input,.modal-form select,.modal-form textarea{width:100%;padding:10px 12px;border:2px solid #e5e7eb;border-radius:10px;font-size:14px;background:#fff}
    .modal-form textarea{min-height:90px;resize:vertical}

    /* Responsive */
    @media (max-width:1024px){
      .settings-grid{grid-template-columns:1fr;gap:20px}
    }
    @media (max-width:768px){
      .mobile-menu-toggle{display:block}
      .sidebar{transform:translateX(-100%)}
      .sidebar.active{transform:translateX(0)}
      .main-content{margin-left:0}
      .header{flex-direction:column;gap:20px;text-align:center;margin-top:60px}
      .content-grid{grid-template-columns:1fr}
      .dashboard-metrics{grid-template-columns:1fr}
      .container{padding:15px}
    }
  </style>
</head>

<body>
  <div id="modal-root"></div>

  <!-- Botão do menu mobile -->
  <button class="mobile-menu-toggle" onclick="toggleSidebar()">
    <i class="fas fa-bars" aria-hidden="true"></i>
    <span class="sr-only">Abrir menu</span>
  </button>

  <!-- Overlay para fechar o sidebar em telas pequenas -->
  <div class="sidebar-overlay" onclick="toggleSidebar(false)"></div>

  <!-- Sidebar -->
  <nav class="sidebar" id="sidebar" aria-label="Navegação principal">
    <div class="sidebar-header">
      <h2>
        <span class="logo-icon" aria-hidden="true"><i class="fab fa-whatsapp"></i></span>
        WhatsApp Bot
      </h2>
    </div>

    <div class="sidebar-nav">
      <!-- Seção: Principal -->
      <div class="nav-section">
        <div class="nav-section-title">Principal</div>
        <div class="nav-item active" onclick="changeTab('dashboard', this)">
          <i class="fas fa-chart-pie nav-icon" aria-hidden="true"></i>
          <span>Dashboard</span>
        </div>
        <div class="nav-item" onclick="changeTab('numbers', this)">
          <i class="fas fa-phone nav-icon" aria-hidden="true"></i>
          <span>Números Conectados</span>
        </div>
      </div>

      <!-- Seção: Comunicação -->
      <div class="nav-section">
        <div class="nav-section-title">Comunicação</div>
        <div class="nav-item" onclick="changeTab('contacts', this)">
          <i class="fas fa-address-book nav-icon" aria-hidden="true"></i>
          <span>Contatos</span>
        </div>
        <div class="nav-item" onclick="changeTab('messages', this)">
          <i class="fas fa-comments nav-icon" aria-hidden="true"></i>
          <span>Mensagens</span>
          <span class="nav-badge">3</span>
        </div>
        <div class="nav-item" onclick="changeTab('groups', this)">
          <i class="fas fa-users nav-icon" aria-hidden="true"></i>
          <span>Grupos</span>
        </div>
      </div>

      <!-- Seção: Gestão -->
      <div class="nav-section">
        <div class="nav-section-title">Gestão</div>
        <div class="nav-item" onclick="changeTab('finances', this)">
          <i class="fas fa-dollar-sign nav-icon" aria-hidden="true"></i>
          <span>Finanças</span>
        </div>
        <div class="nav-item" onclick="changeTab('settings', this)">
          <i class="fas fa-cog nav-icon" aria-hidden="true"></i>
          <span>Configurações</span>
        </div>
      </div>

      <!-- Seção: Automação -->
      <div class="nav-section">
        <div class="nav-section-title">Automação</div>
        <div class="nav-item" onclick="changeTab('campaigns', this)">
          <i class="fas fa-bullhorn nav-icon" aria-hidden="true"></i>
          <span>Campanhas</span>
        </div>
        <div class="nav-item" onclick="changeTab('macros', this)">
          <i class="fas fa-magic nav-icon" aria-hidden="true"></i>
          <span>Macros</span>
        </div>
        <div class="nav-item" onclick="changeTab('chatbot', this)">
          <i class="fas fa-robot nav-icon" aria-hidden="true"></i>
          <span>Chatbot</span>
        </div>
        <div class="nav-item" onclick="changeTab('schedules', this)">
          <i class="fas fa-calendar-alt nav-icon" aria-hidden="true"></i>
          <span>Agendamentos</span>
        </div>
        <div class="nav-item" onclick="changeTab('reports', this)">
          <i class="fas fa-chart-line nav-icon" aria-hidden="true"></i>
          <span>Relatórios</span>
        </div>
      </div>
    </div>

    <!-- Footer: Seletor de Usuários/Contas -->
    <div class="sidebar-footer">
      <div class="instance-selector" onclick="toggleInstanceMenu()" role="button" aria-haspopup="true" aria-expanded="false">
        <div class="instance-avatar">
          <img id="instanceAvatar"
               src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=80&h=80&fit=crop&crop=faces"
               alt="Avatar do usuário">
          <div class="instance-status"></div>
        </div>
        <div class="instance-info">
          <div class="instance-name" id="currentInstanceName">Sem usuário</div>
          <div class="instance-type" id="currentInstanceType">—</div>
        </div>
        <div class="instance-arrow" aria-hidden="true"><i id="instanceArrow" class="fas fa-chevron-up"></i></div>
      </div>

      <!-- Dropdown com a lista de usuários -->
      <div class="instance-dropdown" id="instanceDropdown">
        <div class="dropdown-header">Trocar usuário</div>
        <div id="instanceList"><!-- render via JS --></div>
        <div class="dropdown-footer">
          <div class="dropdown-action" onclick="userNew()">
            <i class="fas fa-user-plus" aria-hidden="true"></i><span>Novo usuário</span>
          </div>
          <div class="dropdown-action" onclick="userEditActive()">
            <i class="fas fa-user-cog" aria-hidden="true"></i><span>Configurar usuário</span>
          </div>
          <div class="dropdown-action" onclick="toggleInstanceMenu(false)">
            <i class="fas fa-chevron-down" aria-hidden="true"></i><span>Fechar</span>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main -->
  <main class="main-content" role="main">
    <div class="container" id="mainContainer"><!-- conteúdo renderizado via JS --></div>
  </main>

  <script src="/static/app.js"></script>
</body>
</html>